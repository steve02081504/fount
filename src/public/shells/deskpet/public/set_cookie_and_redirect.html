<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta property="og:title" content="fount Deskpet Setup: Awakening Your Companion">
	<meta property="og:type" content="website">
	<meta property="og:description" content="A brief moment of setup to awaken your fount deskpet. Your AI companion is preparing to join you on your desktop.">
	<meta name="description" content="A brief moment of setup to awaken your fount deskpet. Your AI companion is preparing to join you on your desktop." />
	<meta property="og:image" content="/favicon.svg">
	<link rel="icon" type="image/svg+xml" href="/favicon.svg">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Setting up...</title>
</head>

<body>
	<script>
		// Get URL parameters
		const urlParams = new URLSearchParams(window.location.search)
		const apikey = urlParams.get('apikey')
		const redirect = urlParams.get('redirect')

		if (!apikey || !redirect) {
			document.body.innerHTML = '<h1>Error: Missing parameters</h1>'
			return
		}

		// Set API cookie via POST request
		fetch('/api/get-api-cookie', {
			method: 'POST',
			headers: {
				'Content-Type': 'application/json',
			},
			body: JSON.stringify({ apiKey: apikey }),
		})
			.then(response => response.json())
			.then(result => {
				if (result.success)
					// Redirect to the actual pet URL
					window.location.href = decodeURIComponent(redirect)
				else
					document.body.innerHTML = `<h1>Error: ${result.error || 'Failed to set cookie'}</h1>`
			})
			.catch(error => {
				document.body.innerHTML = `<h1>Error: ${error.message}</h1>`
			})
	</script>
</body>

</html>
